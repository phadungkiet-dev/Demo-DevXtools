name: CI Pipeline

# ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£ Push ‡∏´‡∏£‡∏∑‡∏≠ Pull Request ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏µ‡πà branch main ‡πÅ‡∏•‡∏∞ develop
on:
  push:
    branches: ["main", "develop"]
  pull_request:
    branches: ["main", "develop"]

jobs:
  quality-check:
    name: üõ°Ô∏è Quality Check
    runs-on: ubuntu-latest

    steps:
      # 1. ‡∏î‡∏∂‡∏á Code ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏°‡∏≤
      - name: Checkout Repo
        uses: actions/checkout@v4

      # 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Node.js (‡πÉ‡∏ä‡πâ version 20 ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
      - name: Setup Node.js 20
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      # 3. Cache Next.js (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà: ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ Build ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å)
      - name: Next.js Cache
        uses: actions/cache@v4
        with:
          path: |
            .next/cache
          # ‡∏™‡∏£‡πâ‡∏≤‡∏á Key ‡∏à‡∏≤‡∏Å OS ‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå package-lock ‡∏ñ‡πâ‡∏≤ Dependencies ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏ä‡πâ Cache ‡πÄ‡∏î‡∏¥‡∏°
          key: ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-${{ hashFiles('**.[jt]s', '**.[jt]sx') }}
          restore-keys: |
            ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-

      # 4. ‡∏•‡∏á Library ‡∏ï‡πà‡∏≤‡∏á‡πÜ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô npm install)
      - name: Install Dependencies
        run: npm ci

      # 5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Type (TypeScript)
      - name: üîç TypeScript Check
        run: npm run type-check

      # 6. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Code Style (Lint)
      - name: üßπ Lint Check
        run: npm run lint

      # 7. ‡∏•‡∏≠‡∏á Build ‡∏à‡∏£‡∏¥‡∏á (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏û‡∏±‡∏á‡πÑ‡∏´‡∏°)
      - name: üèóÔ∏è Build Test
        run: npm run build
